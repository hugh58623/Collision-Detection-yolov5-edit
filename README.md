# Collision-Detection
Github for paper An Object-Driven Collision Detection with 2D Cameras using Artificial Intelligence and Computer Vision
## Background
As a new product of modern society, artificial intelligence is the future direction of development. It can operate automatically in a specific environment according to a present mode. Without human management, the expected or higher goals can be achieved. Autonomous driving is one of the most popular technologies in artificial intelligence. It can bring great convenience to our lives, and at the same time it is a kind of release to people's fatigue when driving. From the perspective of the nature of autonomous driving, it is essentially a fast-reacting robot, and its level of intelligence is relatively high. If autonomous driving can be achieved, it will mean a huge step forward not only in commuting but also in the field of robotics, as the same level of artificial intelligence can be applied to more standard robots. Whatâ€™s more, autonomous driving technology can provide people with a huge benefit of time. After being released from the requirement to drive, people in the car can do what they want. At this time, the car on the journey is a brand-new space for people's lives, and people will have one more means of living their life than before. The supporting facilities of the car will be completely changed, and passengers can work and entertain. This change in the sense of space provides a new service model and a new life experience for social development. Collision detection is an important issue in automatic driving, which is related to the safety of automatic driving.
## Target
In this project, we did three experiments to finish the distance detection function. First of all, we added distance labels in YOLOv5 so that we can get the real-time information from the screen. Then we collected the dataset of one object to build and test our models. After we prove that the distance information can be obtained. We collected the dataset of different objects to compare the results of different models. Lastly, different cameras were selected to collect the dataset, in order to explore and validate the impact of different camera types.
## Overview of the System
<p align="center">
  <img src="https://github.com/hugh58623/Collision-Detection/blob/main/system%20overview.png?raw=true" alt="Overview of the System"/>
</p>

The proposed system framework is shown in the Figure 1. The input can be submitted in two ways: one is to take photos captured by the camera as input, and the other being to use video as input. After getting the specified data, the program will use a Web API/Web service to handle communication between the frontend, the database and the backend server. This can be implemented in a service such as Python Flask. The database we are using in particular is a non-relational database that holds all of our training data and testing data. This data is utilized to obtain the distance information through the machine learning algorithm and heuristic. Aside from just training data, it also contains important information related to the approximate size of certain objects to help better guide the system. The machine learning portion of the system uses modern regressive machine learning libraries. We will show some testing results for a variety of the common models such as Linear Regression, Polynomial regression, and Random Forest Regression.. After undergoing all of this processing in our backend web server, the picture or video with the distance information is returned to the display screen as output. If it is a video, it dynamically updates the screen with the most recent distance information. For a picture, it will simply estimate the current distance for the recognized objects.
## EXPERIMENTS
### Experiment 1: Distance Estimation using Machine Learning Models
In this part, we choose several machine learning models to finish distance prediction. We collect the width percentage of the screen with different distances from a person to the camera.
By using this data to predict the distance, we choose the Linear Regression model, Polynomial Ridge Regression model, Random Regression model, and ElasticNet Regression model. For the Polynomial Ridge Regression model, we select different Poly Features, such as 3 Poly Features and 4 Poly Features. For the Random Regression model, we compare 2 max depth models and no max depth models. 
### Experiment 2: The Impact of the Object Type on the Distance Estimation
In this part, we choose several machine learning models to finish distance prediction and compare the influence of object type. Besides the data we collect in experiment 1, we also collect the data of different objects, such as the cell phone and stuffed penguin.
By using this data to predict the distance, we choose the Linear Regression model, Polynomial Ridge Regression model, Random Regression model, and ElasticNet Regression model. For the Polynomial Ridge Regression model, we select different Poly Features, such as 3 Poly Features and 4 Poly Features. For the Random Regression model, we compare 2 max depth models and no max depth models. 
### Experiment 3: The Impact of the Camera Type on the Distance Estimation
In this part, we choose several machine learning models to finish distance prediction and compare the influence of camera type. Besides the data we collect in experiment 1 and 2, we also collect the data of the second person using a different camera (Dell G5).
By using this data to predict the distance, we choose the Linear Regression model, Polynomial Ridge Regression model, Random Regression model, and ElasticNet Regression model. For the Polynomial Ridge Regression model, we select different Poly Features, such as 3 Poly Features and 4 Poly Features. For the Random Regression model, we compare 2 max depth models and no max depth models. 
## Results
<p align="center">
  <img src="https://github.com/hugh58623/Collision-Detection/blob/main/Cross%20Validation%20Average%20Testing%20Scores.png?raw=true" alt="Cross Validation Average Testing Scores"/>
</p>
This figure shows the Cross Validation Average Testing Scores for different model. From Figure 6, we can know that Random Forest (depth=2) get the highest score and ElasticNet Regression get the lowest score. In this way, we could say Random Forest (depth=2) is the most suitable model for the data.
<p align="center">
  <img src="https://github.com/hugh58623/Collision-Detection/blob/main/Feature%20Importance.png?raw=true" alt="Feature Importance"/>
</p>
This figure shows the influence of various factors on distance prediction. We can know that the percentage of screen width is the most important factor to predict the distance. The camera and the object has less influence on prediction.
